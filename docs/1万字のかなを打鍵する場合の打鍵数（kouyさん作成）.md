# 1万字のかなを打鍵する場合の打鍵数（kouyさん作成）

[1万字のかなを入力する場合の打鍵数 : ローマ字入力でもなく、かな入力でもなく](https://kouy.exblog.jp/7888078/)

keycount.odsをダウンロードして、Googleスプレッドシートで使ってみます。

## 使ってみる

スプレッドシートでそのまま使えるかは分からないけれど。ローマ字以外はちょっとバグってるのでLibreOfficeで見てみます。

一部化けている文字もありますが、月の数値は合っているのでとりあえずOK。

## 計算方法を理解する

月配列2-263式をみます。

計算式は割と複雑で気合いで作ってるっぽい？Qキーの式は以下の通り。

Qキーは
単打: そ
濁点後置: ぞ
右シフト: ぁ

なので、これらの出現回数を足していけばよい。VLOOKUPの使い方を知らないので調べる。

```
=VLOOKUP(BM3,$X.$A$1:$X.$C$134,2,0)
+VLOOKUP(BM8,$X.$A$1:$X.$C$134,2,0)
+VLOOKUP(BM13,$X.$A$1:$X.$C$134,2,0)
+VLOOKUP(BM18,$X.$A$1:$X.$C$134,2,0)
```

VLOOKUP(検索値,範囲,列番号,検索の型)

ある値を、ある範囲から探し、見つかった行の何列目かを返す関数。つまり"そ"、"ぁ"、"ぞ"の出現回数を足し合わせている。シートXは各文字の出現回数が書かれたシート。

他のキーについても見てみる。シフトキーと濁点キーの計算方法が気になる。まずはシフトキー（D）から。

Dキーは
右のシフト面のキーを打鍵する時
シフト: ら

の時に使う。

```
=SUM(BV11,BW11,BV21,BW21)
+VLOOKUP(BO4,$X.A$1:$X.$C$134,2,0)
+VLOOKUP(BO9,$X.$A$1:$X.$C$134,2,0)
+VLOOKUP(BO14,$X.$A$1:$X.$C$134,2,0)
+VLOOKUP(BO19,$X.$A$1:$X.$C$134,2,0)
```

BV11、BW11には別の計算式が書かれている。右範囲のシフト面の出現回数を計算していると思われるが、文字化けしている。計算式を見てみよう。

BV11は右手側の下半分、BW11は右手側の上半分の回数を計算していた。何で小数になっているのかはよく分からんが...。

## 自分で使ってみる

月のシートをコピーして実際に使ってみることにしよう。

## メモ

配列のヒートマップで使われているのを見かけるので、自作配列の分析に使ってみようと思います。

気になっているのは、配列によって打鍵数を数えるための区切りが違うので、それをどう共通化しているのかということ。

例えばローマ字だったら「ふぁ」は「ふ」「ぁ」に分けて計算できない。あとは「ん」は後ろにナ行や母音が来る場合は2打鍵になる、みたいなルールもある。きゃきゅきょなどの拗音を分けて入力する配列もあれば、そうでない配列もある。

> ・「っ」は次に子音（n以外）が来る場合はその子音で入力。その他は単独で入力。（ただし、「っ」の次に「っ」が来る場合は、最初の「っ」は単独で入力したと見なす）<br>
> ・「ん」は次にあ行、な行、や行が来る場合は[N][N]で入力。それ以外は[N]で入力。

ローマ字についてきちんと考慮されている。

> 今回の画像を作るために、『OpenOffice.org Calc』で作った表計算ファイルを置いておきます。今回画像を作った配列以外の配列のデータも入っています。

> 一応、他のサンプルで調べたり、他の配列の打鍵数も調べることもできるように作りました。

ある程度は他の配列でも使えるように作られているとのこと。

"きょ"について、"き"と"ょ"でまずは計算してそれから"きょ"の数だけ引く、というやり方が使われている？

keycount.odsをダウンロードして、スプレッドシートで開いてみることにしよう。