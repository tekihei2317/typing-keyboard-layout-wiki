# とりあえず配列を作ってみよう

どこから手をつけていいのか分からなかったので、とりあえず作ってみることにしよう。

条件は、

- キー範囲は30キー
- ローマ字テーブルで実装できること（順次打鍵）
- アルペジオ重視
- タイピングゲームでの打鍵効率（かな / 打鍵数）が高いこと

にします。

## やること

- タイピングゲームでの文字の出現頻度を調べる（前WTは調べた）
- とりあえず打鍵効率の高い配列を作る。打鍵効率を高くするためのアイデアも取り入れる
- アルペジオを増やすための工夫を考える

## タイピングゲームでの文字の出現頻度を調べる

[WT公式ワード4のかな出現頻度](../data/WT公式ワード4のかな出現頻度.tsv)

## とりあえず配列を作ってみて、打鍵効率を評価しよう

打鍵効率を高めるんだったら、とりあえず出現頻度の高いキーを順番に通常面に配置すればOK。

記号以外は30キーに収められるようにする。

配列を作ったら、配列から打鍵効率を計算するツールを作って評価する。月配列とブリ中トロ配列と比較する。

[かな入力配列に必要な文字一覧](./かな入力配列に必要な文字一覧.md)

## 案2

### 前提条件

月配列と同じく中指前置シフトを使用する。覚えやすさのために清濁同置にする。配置したい文字は清音46、濁音・半濁音26、小書き9、記号3（句読点と長音）の84キー。

シフト面2つ使うと30 + 30 + 30 = 90キー程度配置でき、シフトキーの同指連続を避けると30+27+27=84でちょうどになる。実際は中黒（・）を入れることになるかもしれない。

シフトはブリ中トロ配列と同じく句読点を兼ねることにする。

イメージを掴むため、まずは濁音になるかなを適当に配置してみる。実際には、濁音になる文字はシフト面・あんシフト面の同じ場所には一つだけ配置するようにする。

### 濁音化するカナを仮置き

濁音化する20 + 1（う）を、シフトキーのある列を避けて配置してみる。

かき　けこ さし　せそ
たち、てと はひ。へほ
　く　つ　 うす　ふ　

読点（、）前置を濁音シフト、句点（。）前置を半濁音シフトにすることにしよう。連想しやすくてオシャレだ。

シフト1（読点シフト）

がぎ　げご ざじ　ぜぞ
だぢ　でど ばび　べぼ
　ぐ　づ　 ゔず　ぶ　

シフト2（句点シフト）

　　　　　 　　　　　
　　　　　 ぱぴ　ぺぽ
　　　　　 　　　ぷ　

### 仕様頻度の高い順番に仮置き

最後に、残ったキーを仕様頻度の高い順番に左上から埋めてみよう。 あ行（う除く）、な行、ま行、や行、ら行、わ行の4+5+5+3+5+3=25かなと、小書き9かな、記号（ー）1カナがの35カナが残っている。空きスペースは41個で、シフトの列の3x2マスを除外するとピッタリになる。

無シフト:

かきいけこ さしんせそ
たち、てと はひ。へほ
のくなつょ うすりふっ

い、ん、の、な、ょ、 り、っを追加。

シフト1（読点シフト）

がぎ　げご ざじにぜぞ
だぢ　でど ばびーべぼ
まぐ　づら ゔずるぶお

に、ー、ま、ら、る、おを追加。

シフト2（句点シフト）

あ、れ、み、も、ゅ、め、わ、え、ゃ、や、ろ、を、よ、む、ね、ゆ、ぬ、ぃ、ぁ、ぇ、ぅ、ぉを追加。ピッタリ埋まった。

あれみもゅ めわ　えゃ
やろをよむ ぱぴ　ぺぽ
ねゆぬぃぁ ぇぅ　ぷぉ

完成系:

- 30キー
- 中指前置シフト、句読点兼用
- 読点（、）は濁点シフト、句点（。）は半濁点シフト
- 清濁同置

かきいけこ さしんせそ
たち、てと はひ。へほ
のくなつょ うすりふっ

がぎ　げご ざじにぜぞ
だぢ　でど ばびーべぼ
まぐ　づら ゔずるぶお

あれみもゅ めわ　えゃ
やろをよむ ぱぴ　ぺぽ
ねゆぬぃぁ ぇぅ　ぷぉ

これが条件を満たす一つの解。解の中で、打鍵効率、指負担（行、列）のバランス、速度を考えて最良のものを探していきたい。

→頻度の低いは行が通常レイヤーに現れるのはあんまり嬉しくない。なのでは行については例外を設けた方がよさそう。例えば、か行の句点シフトをぱ行にするとよさそう。

に、ー、ま、ら、る、お、あが28位までに入っているので、これをひ（47位）、ふ（49位）、へ（72位）、ほ（56位）と入れ替えた方がよい。は（23位）。

月配列で通常面だけどこの配列でシフト面に入っているのは、"に"（16位）、"れ"（29位）、"る"（24位）だ。

## 最適化問題として解く

上記のシフト方式を使う場合、

q→c1
w→c2
e→c3
...
dq→c4
dw→c5
de→c6
...

のように配置を決める問題だと考えられる。


## 参考

[キーボードを最適に | kana_arranger](https://mobitan.github.io/kana_arranger/)

## 行ごとに分類してみる

文字    頻度    割合(%)
い      1170    6.13
う      990     5.19
お      278     1.46
あ      277     1.45
え      160     0.84

か      663     3.47
き      558     2.92
く      552     2.89
こ      374     1.96
が      246     1.29
け      216     1.13
ぎ      111     0.58
ご      89      0.47
げ      86      0.45
ぐ      75      0.39

し      796     4.17
じ      334     1.75
さ      296     1.55
す      262     1.37
せ      232     1.22
そ      123     0.64
ざ      65      0.34
ず      59      0.31
ぜ      46      0.24
ぞ      28      0.15

た      564     2.95
と      385     2.02
つ      306     1.60
ち      278     1.46
て      242     1.27
で      181     0.95
だ      179     0.94
ど      178     0.93
づ      11      0.06

の      757     3.97
な      467     2.45
に      348     1.82
ね      100     0.52
ぬ      23      0.12

は      292     1.53
ば      166     0.87
ひ      127     0.67
ふ      118     0.62
ぶ      109     0.57
び      108     0.57
ほ      101     0.53
ぼ      76      0.40
ぱ      58      0.30
ぷ      53      0.28
べ      51      0.27
ぴ      31      0.16
ぽ      30      0.16
へ      24      0.13
ぺ      18      0.09

ま      316     1.66
み      230     1.20
も      224     1.17
め      189     0.99
む      107     0.56

り      365     1.91
ら      301     1.58
る      292     1.53
れ      254     1.33
ろ      139     0.73

や      145     0.76
よ      108     0.57
ゆ      64      0.34

ん      1149    6.02
わ      165     0.86
を      108     0.57

ょ      378     1.98
っ      360     1.89
ゅ      203     1.06
ゃ      160     0.84
ぃ      21      0.11
ぁ      8       0.04
ぇ      7       0.04

ー      325     1.70

。      1       0.01
